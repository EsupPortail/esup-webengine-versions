<h:panelGroup layout="block"
xmlns="http://www.w3.org/1999/xhtml"
xmlns:nxu="http://nuxeo.org/nxweb/util"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:a4j="http://richfaces.org/a4j"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:c="http://java.sun.com/jstl/core"
xmlns:nxh="http://nuxeo.org/nxweb/html"
xmlns:nxl="http://nuxeo.org/nxforms/layout"
xmlns:fn="http://java.sun.com/jsp/jstl/functions"
xmlns:nxd="http://nuxeo.org/nxweb/document">
<h3><h:outputText value="#{messages['label.permalink.esupversions.title']}" /></h3>
<div class="content">
<p class="popUpDescription">
<h:outputFormat value="#{messages['label.permalink.esupversions.description']} #{currentDocument.title}"/>
</p>
<c:set var="baseURL" value="${fn:replace(facesContext.externalContext.request.requestURL, facesContext.externalContext.request.requestURI, facesContext.externalContext.request.contextPath)}" />
<c:if test="#{!currentDocument.isProxy()}">
       <c:set var="docUUID" value="#{currentDocument.getId()}" />
       <h:inputText class="permalinkFocus" readonly="true" onclick="javascript:this.focus();this.select();" size="120" value="#{baseURL}/site/esupversions/#{docUUID}"/>
    </c:if>
    <c:if test="#{currentDocument.isProxy()}">
        <nxu:methodResult name="docVersion" value="#{documentManager.getSourceDocument(currentDocument.getRef())}">
            <c:set var="docUUID" value="#{docVersion.getId()}" />
            <h:inputText class="permalinkFocus" readonly="true" onclick="javascript:this.focus();this.select();" size="120" value="#{baseURL}/site/esupversions/#{docUUID}"/>
        </nxu:methodResult>
    </c:if>
<h:outputScript target="#{pageJsTarget}">
jQuery('.permalinkFocus').focus();jQuery('.permalinkFocus').select();
</h:outputScript>
</div>
</h:panelGroup>

